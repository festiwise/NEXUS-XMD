const{cmd}=require('../command');const{getBuffer,fetchJson}=require('../lib/functions');cmd({pattern:"person",react:"👤",alias:["userinfo","profile"],desc:"Getcompleteuserprofileinformation",category:"utility",use:'.person[@tagorreply]',filename:__filename},async(conn,mek,m,{from,sender,isGroup,reply,quoted,participants})=>{try{//1.DETERMINETARGETUSERletuserJid=quoted?.sender||mek.message?.extendedTextMessage?.contextInfo?.mentionedJid?.[0]||sender;//2.VERIFYUSEREXISTSconst[user]=awaitconn.onWhatsApp(userJid).catch(()=>[]);if(!user?.exists)returnreply("❌UsernotfoundonWhatsApp");//3.GETPROFILEPICTUREletppUrl;try{ppUrl=awaitconn.profilePictureUrl(userJid,'image');}catch{ppUrl='https://i.ibb.co/KhYC4FY/1221bc0bdd2354b42b293317ff2adbcf-icon.png';}//4.GETNAME(MULTI-SOURCEFALLBACK)letuserName=userJid.split('@')[0];try{//Trygroupparticipantinfofirstif(isGroup){constmember=participants.find(p=>p.id===userJid);if(member?.notify)userName=member.notify;}//TrycontactDBif(userName===userJid.split('@')[0]&&conn.contactDB){constcontact=awaitconn.contactDB.get(userJid).catch(()=>null);if(contact?.name)userName=contact.name;}//Trypresenceasfinalfallbackif(userName===userJid.split('@')[0]){constpresence=awaitconn.presenceSubscribe(userJid).catch(()=>null);if(presence?.pushname)userName=presence.pushname;}}catch(e){console.log("Namefetcherror:",e);}//5.GETBIO/ABOUTletbio={};try{//TrypersonalstatusconststatusData=awaitconn.fetchStatus(userJid).catch(()=>null);if(statusData?.status){bio={text:statusData.status,type:"Personal",updated:statusData.setAt?newDate(statusData.setAt*1000):null};}else{//TrybusinessprofileconstbusinessProfile=awaitconn.getBusinessProfile(userJid).catch(()=>null);if(businessProfile?.description){bio={text:businessProfile.description,type:"Business",updated:null};}}}catch(e){console.log("Biofetcherror:",e);}//6.GETGROUPROLEletgroupRole="";if(isGroup){constparticipant=participants.find(p=>p.id===userJid);groupRole=participant?.admin?"👑Admin":"👥Member";}//7.FORMATOUTPUTconstformattedBio=bio.text?`${bio.text}\n└─📌${bio.type}Bio${bio.updated?`|🕒${bio.updated.toLocaleString()}`:''}`:"Nobioavailable";constuserInfo=`*GCMEMBERINFORMATION🧊*📛*Name:*${userName}🔢*Number:*${userJid.replace(/@.+/,'')}📌*AccountType:*${user.isBusiness?"💼Business":user.isEnterprise?"🏢Enterprise":"👤Personal"}*📝About:*${formattedBio}*⚙️AccountInfo:*✅Registered:${user.isUser?"Yes":"No"}🛡️Verified:${user.verifiedName?"✅Verified":"❌Notverified"}${isGroup?`👥*GroupRole:*${groupRole}`:''}`.trim();//8.SENDRESULTawaitconn.sendMessage(from,{image:{url:ppUrl},caption:userInfo,mentions:[userJid]},{quoted:mek});}catch(e){console.error("Personcommanderror:",e);reply(`❌Error:${e.message||"Failedtofetchprofile"}`);}});