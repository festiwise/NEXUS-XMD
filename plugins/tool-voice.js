const{cmd}=require('../command');constaxios=require('axios');cmd({pattern:"aivoice",alias:["vai","voicex","voiceai"],desc:"TexttospeechwithdifferentAIvoices",category:"main",react:"🪃",filename:__filename},async(conn,mek,m,{from,quoted,body,isCmd,command,args,q,isGroup,sender,senderNumber,botNumber2,botNumber,pushname,isMe,isOwner,groupMetadata,groupName,participants,groupAdmins,isBotAdmins,isAdmins,reply})=>{try{//Checkifargs[0]exists(userprovidedtext)if(!args[0]){returnreply("Pleaseprovidetextafterthecommand.\nExample:.aivoicehello");}//GetthefullinputtextconstinputText=args.join('');//Sendinitialreactionawaitconn.sendMessage(from,{react:{text:'⏳',key:m.key}});//VoicemodelmenuconstvoiceModels=[{number:"1",name:"HatsuneMiku",model:"miku"},{number:"2",name:"Nahida(Exclusive)",model:"nahida"},{number:"3",name:"Nami",model:"nami"},{number:"4",name:"Ana(Female)",model:"ana"},{number:"5",name:"OptimusPrime",model:"optimus_prime"},{number:"6",name:"Goku",model:"goku"},{number:"7",name:"TaylorSwift",model:"taylor_swift"},{number:"8",name:"ElonMusk",model:"elon_musk"},{number:"9",name:"MickeyMouse",model:"mickey_mouse"},{number:"10",name:"KendrickLamar",model:"kendrick_lamar"},{number:"11",name:"AngelaAdkinsh",model:"angela_adkinsh"},{number:"12",name:"Eminem",model:"eminem"}];//CreatemenutextletmenuText="╭━━━〔*AIVOICEMODELS*〕━━━⊷\n";voiceModels.forEach(model=>{menuText+=`┃▸${model.number}.${model.name}\n`;});menuText+="╰━━━⪼\n\n";menuText+=`📌*Replywiththenumbertoselectvoicemodelfor:*\n"${inputText}"`;//SendmenumessagewithimageconstsentMsg=awaitconn.sendMessage(from,{image:{url:"https://files.catbox.moe/7zfdcq.jpg"},caption:menuText},{quoted:m});constmessageID=sentMsg.key.id;lethandlerActive=true;//Settimeouttoremovehandlerafter2minutesconsthandlerTimeout=setTimeout(()=>{handlerActive=false;conn.ev.off("messages.upsert",messageHandler);reply("⌛Voiceselectiontimedout.Pleasetrythecommandagain.");},120000);//MessagehandlerfunctionconstmessageHandler=async(msgData)=>{if(!handlerActive)return;constreceivedMsg=msgData.messages[0];if(!receivedMsg||!receivedMsg.message)return;constreceivedText=receivedMsg.message.conversation||receivedMsg.message.extendedTextMessage?.text||receivedMsg.message.buttonsResponseMessage?.selectedButtonId;constsenderID=receivedMsg.key.remoteJid;constisReplyToBot=receivedMsg.message.extendedTextMessage?.contextInfo?.stanzaId===messageID;if(isReplyToBot&&senderID===from){clearTimeout(handlerTimeout);conn.ev.off("messages.upsert",messageHandler);handlerActive=false;awaitconn.sendMessage(senderID,{react:{text:'⬇️',key:receivedMsg.key}});constselectedNumber=receivedText.trim();constselectedModel=voiceModels.find(model=>model.number===selectedNumber);if(!selectedModel){returnreply("❌Invalidoption!Pleasereplywithanumberfromthemenu.");}try{//Showprocessingmessageawaitconn.sendMessage(from,{text:`🔊Generatingaudiowith${selectedModel.name}voice...`},{quoted:receivedMsg});//CalltheAPIconstapiUrl=`https://api.agatz.xyz/api/voiceover?text=${encodeURIComponent(inputText)}&model=${selectedModel.model}`;constresponse=awaitaxios.get(apiUrl,{timeout:30000//30secondstimeout});constdata=response.data;if(data.status===200){awaitconn.sendMessage(from,{audio:{url:data.data.oss_url},mimetype:"audio/mpeg"//Removedptt:truetosendasregularaudio},{quoted:receivedMsg});}else{reply("❌Errorgeneratingaudio.Pleasetryagain.");}}catch(error){console.error("APIError:",error);reply("❌Errorprocessingyourrequest.Pleasetryagain.");}}};//Registerthehandlerconn.ev.on("messages.upsert",messageHandler);}catch(error){console.error("CommandError:",error);reply("❌Anerroroccurred.Pleasetryagain.");}});