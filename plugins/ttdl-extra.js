const{cmd}=require('../command');constfetch=require('node-fetch');cmd({pattern:"tiktok2",alias:["tt2","tiktokdl2","ttdown2","tiktokvid2","ttdl"],desc:"DownloadTikTokvideosusingalink.",category:"downloader",filename:__filename},async(conn,mek,m,{from,args,quoted,reply})=>{try{//Validateinputif(!args[0]){returnreply(`✳️Usethiscommandlike:\n*${command}<TikToklink>*`);}reply("⏳Fetchingvideodetails...Pleasewait.");constres=awaitfetch(`https://darkcore-api.onrender.com/api/tiktok?url=${encodeURIComponent(args[0])}`);if(!res.ok){returnreply("❎Unabletofetchdata.Pleasetryagainlater.");}constdata=awaitres.json();if(!data.success){returnreply("❎Failedtofetchvideo.Pleasecheckthelinkandtryagain.");}const{author,titulo,thumbanail,mp4,mp3}=data.result;//Sendtheinitialoptionswithathumbnailconstcaption=`📖*Title:*${titulo}\n👤*Author:*${author}\n\n📥*Replywith:*\n1️⃣for*Video*\n2️⃣for*Audio*`;constmenuMsg=awaitconn.sendMessage(from,{image:{url:thumbanail},caption},{quoted:mek});//Waitfortheusertoreplywiththeoptionconn.ev.on('messages.upsert',async(msgUpdate)=>{constmsg=msgUpdate.messages[0];if(!msg.message||!msg.message.extendedTextMessage)return;constuserReply=msg.message.extendedTextMessage.text.trim();//Ensuretheuserreplyreferencesthecorrectmessageif(msg.message.extendedTextMessage.contextInfo&&msg.message.extendedTextMessage.contextInfo.stanzaId===menuMsg.key.id){if(userReply==='1'){//Sendvideoawaitconn.sendMessage(from,{video:{url:mp4},caption:"🎥*HereisyourTikTokvideo!*"},{quoted:mek});}elseif(userReply==='2'){//Sendaudioawaitconn.sendMessage(from,{audio:{url:mp3},mimetype:'audio/mpeg',caption:"🎵*Hereistheextractedaudio!*"},{quoted:mek});}else{reply("❎Invalidoption.Pleasereplywith`1`forvideoor`2`foraudio.");}}});}catch(error){console.error(error);reply("❎Anerroroccurredwhileprocessingyourrequest.Pleasetryagainlater.");}});